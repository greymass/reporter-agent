---
import BaseLayout from './BaseLayout.astro';
import Sidebar from '../components/Sidebar.astro';
import Breadcrumbs from '../components/Breadcrumbs.astro';
import ReportNavigation from '../components/ReportNavigation.astro';

interface Props {
  title: string;
  month: string;
  reportType: string;
  description?: string;
}

const { title, month, reportType, description } = Astro.props;

// Format month for better description
const [year, monthNum] = month.split('-');
const monthName = new Date(parseInt(year), parseInt(monthNum) - 1).toLocaleDateString('en-US', { 
  month: 'long', 
  year: 'numeric' 
});

// Generate description based on report type
const defaultDescription = reportType.toLowerCase() === 'readme' 
  ? `Executive summary of Greymass development activity for ${monthName}`
  : reportType.toLowerCase() === 'technical'
  ? `Technical details of development work completed during ${monthName}`
  : `Research data and metrics for ${monthName}`;

const finalDescription = description || defaultDescription;
---

<BaseLayout title={title} description={finalDescription} type="article">
  <div class="drawer lg:drawer-open">
    <input id="my-drawer" type="checkbox" class="drawer-toggle" />
    <div class="drawer-content">
      <!-- Mobile menu button -->
      <div class="lg:hidden flex items-center p-4 bg-base-200">
        <label for="my-drawer" class="btn btn-primary btn-sm drawer-button">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16" />
          </svg>
          Reports
        </label>
      </div>
      
      <!-- Main content -->
      <div class="container mx-auto px-4 py-8 max-w-4xl">
        <Breadcrumbs month={month} reportType={reportType} />
        
        <ReportNavigation currentMonth={month} currentType={reportType.toLowerCase()} />
        
        <article class="prose prose-lg max-w-none">
          <slot />
        </article>
        
        <ReportNavigation currentMonth={month} currentType={reportType.toLowerCase()} />
      </div>
    </div>
    
    <!-- Sidebar -->
    <Sidebar />
  </div>
</BaseLayout>
